<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: linux | 书写|记下人生痕迹]]></title>
  <link href="http://towriting.com/blog/categories/linux/atom.xml" rel="self"/>
  <link href="http://towriting.com/"/>
  <updated>2015-09-10T23:50:45+00:00</updated>
  <id>http://towriting.com/</id>
  <author>
    <name><![CDATA[ToWriting]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Linux下开启TRIM]]></title>
    <link href="http://towriting.com/blog/2014/06/28/archlinux-trim/"/>
    <updated>2014-06-28T21:55:12+00:00</updated>
    <id>http://towriting.com/blog/2014/06/28/archlinux-trim</id>
    <content type="html"><![CDATA[<p>新买得一块SSD，听说开启TRIM才能更好的发挥SSD的性能，Linux并没有默认开启TRIM，但开启还是比较简单。</p>

<p>首先要检测SSD是否支持TRIM:</p>

<p><code>bash
sudo hdparm -I /dev/sda | grep "TRIM supported"
</code>
如果支持则会出现："Data Set Management TRIM supported"</p>

<p>如果SSD支持TRIM, 则可以开启TRIM了, 这里介绍常用的两种方法。</p>

<h3>方法1：修改<a href="http://en.wikipedia.org/wiki/Fstab">fstab</a>, 添加discard属性</h3>

<p><code>bash
sudo vim /etc/fstab
</code></p>

<p>下面是我机器上fstab的配置</p>

<blockquote><p>UUID=27dd31b4-8aa4-4043-b921-540a312c056c       /               ext4            rw,relatime,data=ordered,<strong>discard</strong>        0 1</p>

<p>UUID=42f79958-0776-4b2f-8aa3-db827bf257b6       /home           ext4            rw,relatime,data=ordered,<strong>discard</strong>        0 2</p></blockquote>

<h3>方法2：使用fstrim定期执行trim任务</h3>

<p>以我用的archlinux为例，首先安装并运行<a href="http://en.wikipedia.org/wiki/Cron">cron</a>服务：
<code>bash
sudo pacman -S cronie
sudo systemctl start cronie
sudo systemctl enable cronie
</code></p>

<p>然后创建一个任务配置:
<code>bash
sudo gedit /etc/cron.daily/trim
</code></p>

<p>并将下面的内容拷贝到里面：
```</p>

<h1>!/bin/sh</h1>

<p>LOG=/var/log/trim.log
echo &ldquo;<strong><em> $(date -R) </em></strong>&rdquo; >> $LOG
fstrim -v / >> $LOG
fstrim -v /home >> $LOG
```</p>

<p>参考：</p>

<ol>
<li><p><a href="http://www.webupd8.org/2013/01/enable-trim-on-ssd-solid-state-drives.html">http://www.webupd8.org/2013/01/enable-trim-on-ssd-solid-state-drives.html</a></p></li>
<li><p><a href="https://wiki.archlinux.org/index.php/Solid_State_Drives">https://wiki.archlinux.org/index.php/Solid_State_Drives</a></p></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bg,Fg,&,Ctrl-Z -- 5个例子搞定Unix(linux)后台任务]]></title>
    <link href="http://towriting.com/blog/2013/08/03/unix-background-job/"/>
    <updated>2013-08-03T19:25:00+00:00</updated>
    <id>http://towriting.com/blog/2013/08/03/unix-background-job</id>
    <content type="html"><![CDATA[<p>当你执行一个要花费很长时间的unix脚本或者命令时，你可以在后台执行这个任务。</p>

<p>在这篇文章中，让我们回顾一下如何执行一个任务到后台、将任务切换到前台、查看所有后台任务和结束一个后台任务。</p>

<h2>1. 执行一个后台任务</h2>

<p>在命令后面添加<a href="https://en.wikipedia.org/wiki/Ampersand">&amp;</a>就可以将任务执行到后台。</p>

<p>比如，当你执行一个可能耗时很长的查找命令，你可以像下面例子中一样将它执行到后台。下面的例子将查找root目录下24小时内被修改过的文件：
<code>bash
$ find / -ctime -1 &gt; /tmp/changed-file-list.txt &amp;
</code></p>

<h2>2. 通过CTRL-Z和bg命令将当前任务切换到后台</h2>

<p>你也可以将一个已经运行的前台任务切换到后台：</p>

<ul>
<li>组合键 ‘CTRL+Z’ 将暂停当前任务。</li>
<li>执行bg将任务切换到后台执行</li>
</ul>


<p>像下面的例子，假如你忘记将任务执行到后台，你无需结束当前任务再启动一个新的后台任务。你可以暂停当前任务然后将它切换到后台：</p>

<p>```bash
$ find / -ctime -1 > /tmp/changed-file-list.txt</p>

<p>$ <a href="http://www.thegeekstuff.com/2010/05/unix-background-job/">CTRL-Z</a>+  Stopped                 find / -ctime -1 > /tmp/changed-file-list.txt</p>

<p>$ bg
```</p>

<h2>3. 使用jobs命令查看所有后台任务</h2>

<p>你可以使用<strong>jobs</strong>命令列出所有后台任务。一个jobs命令的可能输出如下：</p>

<p><code>bash
$ jobs
[1]   Running                 bash download-file.sh &amp;
[2]-  Running                 evolution &amp;
[3]+  Done                    nautilus .
</code></p>

<h2>4. 通过fg命令将后台任务切换到前台</h2>

<p>你可以通过<strong>fg</strong>命令将后台任务切换到前台。如果执行fg命令不带参数，则将最近的后台任务切换到前台。
<code>bash
$ fg
</code>
假如你有多个后台任务，你又想将指定任务切换到前台，那你可以先执行jobs命令列出所有任务号和对应命令。下面的例子，fg %1将一号任务(download-file.sh)切换到前台。
```bash
$ jobs
<a href="https://en.wikipedia.org/wiki/Ampersand">1</a>   Running                 bash download-file.sh &amp;
<a href="http://www.thegeekstuff.com/2010/05/unix-background-job/">2</a>&ndash;  Running                 evolution &amp;
<a href="http://toWriting.com">3</a>+  Done                    nautilus .</p>

<p>$ fg %1
```</p>

<h2>5. 通过kill %结束指定的后台任务</h2>

<p>假如你想杀死指定的后台任务，用<strong>kill</strong> %任务号就行了。下面是杀死2号任务的例子：
<code>bash
$ kill %2
</code>
译者：<a href="http://toWriting.com">toWriting.com</a>；翻译自：<a href="http://www.thegeekstuff.com/2010/05/unix-background-job/">Bg, Fg, &amp;, Ctrl-Z – 5 Examples to Manage Unix Background Jobs</a></p>
]]></content>
  </entry>
  
</feed>
