
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>书写|记下人生痕迹</title>
  <meta name="author" content="ToWriting">

          
        <meta name="description" content="记录人生痕迹|分享技术心得 -- ToWriting.com. 一个立志独立思维的程序员的博客网站. 这里会记录下自己工作, 生活和回忆; 同时会分享编程等相关技术知识; 所有文章皆为原创或翻译.">
        <meta name="keywords" content="阅读,思考,书写,程序员,C++">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://towriting.com/blog/page/3">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="书写|记下人生痕迹" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/jquery-1.9.1.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
 
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-42601840-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  class="collapse-sidebar sidebar-footer" >
  <header role="banner">
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:towriting.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2014/07/21/review-xzjy/">读《寻找家园》</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-07-21T23:51:23+00:00" pubdate data-updated="true">2014-07-21</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>诚然，这是一本文辞优美的自传集。自以为博学杂收，但此前竟从未听说过高尔泰，概和主流媒介打压有关。80后的我，有幸避过了那段岁月，所以对于书中，高先生凄苦的人生，只能报以同情，很难产生共鸣。高先生悲惨的际遇和余华《活着》中的福贵的一生很像，波诡云谲的时代，至亲“莫名其妙”的离去，种种不公平待遇，最后还活着，随波逐流。</p>

<p>但逆水的鱼，这是天生的命运。高先生最终去了标榜自由平等的米国，广阔天地，但难以大有作为，老来无依，故国不堪回首，所以整理出这<a href='http://www.amazon.cn/gp/product/B00K0E4NFO/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00K0E4NFO&linkCode=as2&tag=bringmeluck-23' rel='external nofollow' target='_blank'>寻找家园</a>来。</p>

<p>读此书，看高尔泰传奇一生，随便拈来一件小事都是我们当代常人一生难逢的际遇，而且即使选中了你我，也并非你我可以承受。反观我们的生活，钢筋水泥的城市，一成不变的工作，三两个不勾心斗角的同事，做着不着调的工作，两点一线，直至老去，有幸的留下荒冢一堆，无运的骨灰都不是自己的！</p>

<p>都市中渺小的我，搞不清高尔泰追求的自由为何物，自由和活着孰重孰轻。年轻的高尔泰似乎没有追求自由的能力，只能任命运摆弄，想着往上爬的，却成了别人的梯子，80年代后，环境宽松，如果懂的迎合，以他的名望和学识，想必日子不会艰难，也不会老来流落米国。</p>

<p>在我看来，自由是，不妨碍他人的前提下，随意做自己想做的事情。所以活着是自由的前提，“不自由，毋宁死”，死了不还是得不到自由！如果高尔泰可以顺从，是否可以摆脱暴力的关照，安心做自己喜欢的事情呢，这不就实现了他的自由了吗？</p>

<p>这种想法有些小人之心度君子之腹了，高尔泰是不会仰人鼻息的!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2014/07/08/evil-refactor/">关于重构的一些想法</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-07-08T00:26:25+00:00" pubdate data-updated="true">2014-07-08</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>很早之前听说过这样一个故事：</p>

<blockquote><p>一个漂亮的女子与马戏团的小丑坠入爱河，并迅速结婚。小丑十分珍惜得来的幸福，努力挣钱，瞒着女子做了整容手术，为了给女子惊喜。整容后的小丑出现在女子眼前时，女子提出离婚，因为他喜欢的是原来长的并不帅的小丑。</p></blockquote>

<p>一个项目重构的动机(目的)无外乎两种：1. 给用户带来更好的体验、2. 项目代码失控（难以维护、添加新特性）。重构必然导致变化，用户接受现在的产品，重构后的版本并不一定喜欢。至于极端，哪怕重构后的版本比老版本好的多，也会有用户高声喊：给我老版本。这和小丑的故事一样了，哪怕整容帅的像郭德纲一样，女子照样甩一甩衣袖走了。</p>

<p>现实生活中的重构往往是程序员自己发起的，Martin Fowler都有一本书起名为《重构》，并被许多程序员奉为圭臬。程序员的初衷是好的，但往往会低估重构的难度，项目越大耦合越多，往往牵一发而动全身，当老板跑过来问你进度时，你只能回以尴尬的笑，因为进度会进入无法掌控的地步。最近自己差点陷入这种进退维谷的境地，还好项目比较小，最后算是挺了过来。</p>

<p>但大的项目移筋动骨的重构就真的很难成功了。记得在核新软件的时候，项目庞大臃肿，添加新功能困难，软件的开发与执行效率都很低。记得一段时间内，大家重构的呼声很高，不过最后不了了之，因为工程浩大、重构后的兼容性、重构后软件多长时间可以稳定、重构后版本的测试等等需要考虑的各种问题已不单单是几个开发可以掌控的了的。而同时产品的需求还是不会减少，因为产品根本不关心软件的技术架构、可靠性、可维护性等等。</p>

<p>产品不关心重构是正常的。确实，一个可以正常运行，用户没有太多投诉、谨慎的编码也不会出太大问题的项目为什么要重构呢？假如某地发现了一个煤矿，第一批人来开采，一年时间采掉了50%的煤; 第二批人来了，煤已不那么好采，必须小心谨慎的对待，因为矿难不断，不过还好花了两年时间采到了30%的煤; 第三批人来了，矿上留下的全是前人留下的坑，无处落脚，须将前面的坑填掉，才能保证采得到煤，先花费了三年填坑，最后又花了一年时间采到了10%的煤。软件开发也一样，软件的生命期有限，是否需要花费人力将软件重构的完美值得商榷，可能重构完成之日，为项目终结之时，留下完美的架构与设计又有何用呢？</p>

<p>既然程序员呼吁重构的理由是，项目代码难以维护，那为什么不从一开始写出易维护的代码？</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2014/06/28/archlinux-trim/">Linux下开启TRIM</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-06-28T21:55:12+00:00" pubdate data-updated="true">2014-06-28</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>新买得一块SSD，听说开启TRIM才能更好的发挥SSD的性能，Linux并没有默认开启TRIM，但开启还是比较简单。</p>

<p>首先要检测SSD是否支持TRIM:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo hdparm -I /dev/sda <span class="p">|</span> grep <span class="s2">&quot;TRIM supported&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>如果支持则会出现：&#8221;Data Set Management TRIM supported&#8221;</p>

<p>如果SSD支持TRIM, 则可以开启TRIM了, 这里介绍常用的两种方法。</p>

<h3>方法1：修改<a href="http://en.wikipedia.org/wiki/Fstab">fstab</a>, 添加discard属性</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo vim /etc/fstab
</span></code></pre></td></tr></table></div></figure>


<p>下面是我机器上fstab的配置</p>

<blockquote><p>UUID=27dd31b4-8aa4-4043-b921-540a312c056c       /               ext4            rw,relatime,data=ordered,<strong>discard</strong>        0 1</p>

<p>UUID=42f79958-0776-4b2f-8aa3-db827bf257b6       /home           ext4            rw,relatime,data=ordered,<strong>discard</strong>        0 2</p></blockquote>

<h3>方法2：使用fstrim定期执行trim任务</h3>

<p>以我用的archlinux为例，首先安装并运行<a href="http://en.wikipedia.org/wiki/Cron">cron</a>服务：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo pacman -S cronie
</span><span class='line'>sudo systemctl start cronie
</span><span class='line'>sudo systemctl <span class="nb">enable </span>cronie
</span></code></pre></td></tr></table></div></figure>


<p>然后创建一个任务配置:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo gedit /etc/cron.daily/trim
</span></code></pre></td></tr></table></div></figure>


<p>并将下面的内容拷贝到里面：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="nv">LOG</span><span class="o">=</span>/var/log/trim.log
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;*** $(date -R) ***&quot;</span> &gt;&gt; <span class="nv">$LOG</span>
</span><span class='line'>fstrim -v / &gt;&gt; <span class="nv">$LOG</span>
</span><span class='line'>fstrim -v /home &gt;&gt; <span class="nv">$LOG</span>
</span></code></pre></td></tr></table></div></figure>


<p>参考：</p>

<ol>
<li><p><a href="http://www.webupd8.org/2013/01/enable-trim-on-ssd-solid-state-drives.html">http://www.webupd8.org/2013/01/enable-trim-on-ssd-solid-state-drives.html</a></p></li>
<li><p><a href="https://wiki.archlinux.org/index.php/Solid_State_Drives">https://wiki.archlinux.org/index.php/Solid_State_Drives</a></p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2014/05/03/dock-project-experience/">Dock项目个人总结</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-05-03T22:55:00+00:00" pubdate data-updated="true">2014-05-03</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Dock说白了是电脑桌面上常驻的一个工作区，Dock的目的是占领用户的桌面，况且我们追赶的团队和追赶我们的团队都已做出Dock，所以应用宝必须也要做。关于应用宝Dock的具体进度、功能与界面不做介绍，现在从开发的角度讲一讲Dock项目两个月来的一点体会。</p>

<p>自己的角色：负责逻辑部分接口和整体框架的设计，及相关功能开发。</p>

<h3>可圈可点之处：</h3>

<hr />

<p><strong>1. 逻辑与界面完全分离</strong></p>

<p>Dock项目应该是，我们团队第一次在多人协作下，采用了界面与逻辑分离的开发方案。这样的好处是：降低了耦合，使开发简单化（做UI的无需关心逻辑，反之依然）。当然这样做必然会增加一些工作量，尤其是后来界面和逻辑分属不同进程，逻辑的接口必须做IPC转发。</p>

<p>逻辑与界面分离的方案，最重要的是定义好接口。</p>

<p><strong>2. 最小完备接口</strong></p>

<p>最小完备接口是我一贯主张的一种接口风格，因为一旦增加冗余的接口，并被客户端代码使用，那就很难移除了，势必造成接口膨胀。项目期间，主管提出接口要提前考虑、功能要丰富的建议，不过自己还是坚持了自己想法。因为加一个接口容易，去掉一个就难了，好比韩愈曾说的，从善如登、从恶如崩。</p>

<h3>败笔之处</h3>

<hr />

<p><strong>1. 任务分配粗略</strong></p>

<p>需求接下来，四个人开始做，一开始定下两个人做界面另两个做逻辑，但没有细化具体的产品细节、开发难度耗时等，也没有分配具体谁做什么事情，只是口头上大概分了一下。这极易导致任务分配不均和任务遗漏的现象。好的方法应该是，细化任务并明确责任，公诸于众。但团队积习如此，非朝夕可改。</p>

<p><strong>2. 线程的滥用</strong></p>

<p>线程滥用当然指逻辑部分。从进入应用宝团队初期，就发现代码中线程滥用，好似每天不开几个线程吃不下饭一般。所以最初Dock的逻辑代码的主框架考虑到了这点，以使后面添加具体业务时无需创建线程。但后期，需求的演变和功能的要求迫使不得不又增加了几个线程，其实有些线程是非必须的。而这些不必要的线程，往往会滋生一批Bug。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2014/04/27/the-gay-genius-review/">读《苏东坡传》</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2014-04-27T21:52:00+00:00" pubdate data-updated="true">2014-04-27</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>昨天在kindle上读完了<a href='http://www.amazon.cn/gp/product/B00D7X84MS/ref=as_li_tf_tl?ie=UTF8&camp=536&creative=3200&creativeASIN=B00D7X84MS&linkCode=as2&tag=bringmeluck-23' rel='external nofollow' target='_blank'>苏东坡传</a>，本以为千年前人物的传记，必简短：年代久远，事迹佚失，有甚可写。谁知此书篇幅不小，断断续续一月才读完，书中夹杂着大量苏东坡的文学作品：诗词和书信等，吾久不读古文，美感失，只好略过。</p>

<p>苏东坡留下了大量的文字，百姓也口口相传着他的轶事，细心严谨的林语堂以此推敲出苏东坡的一生。苏东坡漫长的一生虽坎坷精彩，但也不过如其词云：<strong>大江东去浪淘尽千古风流人物</strong>，读完苏东坡的一生，印象最深的却是如下两个细节：</p>

<h2>&ldquo;太快建立的友情不会长久&rdquo;</h2>

<p>这是苏东坡的妻子王弗在其结交章惇的时候给与他的忠告。当时，苏东坡少年成名，意气风发，想必并不会将这句话放在心里，不久与章惇成为不错的朋友，后来这个朋友让他吃进苦头。历史上章惇到底人品如何，无从得知，不过《苏东坡传》中后来章惇加入“王安石党&#8221;，与苏东坡形同水火，后来章惇得势，打压元祐党人，将苏东坡发配海南，恨不得搞死他。当时他们都年近花甲，想不通为何有如此大的仇怨，何况当时苏东坡丝毫无法威胁到他。</p>

<p>想到这里，突然觉得年轻时的苏东坡可能刺痛过章惇某些敏感的神经。章惇的出身不雅，是个私生子，所以儿时可能受尽奚落，致性格外强内卑。而苏东坡虽性格温婉，但年少轻狂，难免会有些许恃才傲物得罪于人而不自知。凡此种种，最终导致了自己颠沛，起伏的一生。不过人生的不幸，确成就了文坛上的一朵奇葩。</p>

<p>再回头看王弗这就话：太快建立的友情不会长久，是否可以反应她和苏东坡的爱情：太快建立的爱情不会长久。他和苏东坡一见钟情的概率不是很大，因为这桩婚姻是包办的。但一路走来，他们的感情是真挚的，有词为证：</p>

<blockquote><p>十年生死两茫茫。不思量。自难忘。千里孤坟，无处话凄凉。纵使相逢应不识，尘满面，鬓如霜。
夜来幽梦忽还乡。小轩窗。正梳妆。相顾无言，惟有泪千行。料得年年肠断处，明月夜，短松冈。</p></blockquote>

<p>话说这是鄙人高中最喜欢的词。</p>

<h2>人至将死</h2>

<p>另一个给我印象很深的细节是，东坡晚年被贬惠州，想要在住所种植一棵树。他对帮他移植树的人说：树不要太大，太大不容易活；也不要太小，太小自己等不及树长大。读这段时，自己内心戚然，无助感犹然而生。东坡也在很早之前已抒发过此种感慨：</p>

<blockquote><p>寄蜉蝣于天地，渺沧海之一粟。哀吾生之须臾，羡长江之无穷。</p></blockquote>

<p>须臾的人生，意义何在，聪明如苏东坡都想不通，你我又怎能明了！</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/10/11/android-6-dot-0-openssl-crash/">Android 6.0 openssl crash</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/10/a-programmers-rantings/">读<程序员的呐喊></a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/01/14/mongodb-in-elem/">MongoDB中的$in和$elemMatch</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/07/windbg-dump-asso/">Windbg关联dmp文件</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/22/windbg-memory-leak/">Windbg定位内存泄露的一种简单方法</a>
      </li>
    
  </ul>
</section>
<section>
  <h2>文章分类</h2>
    <ul id="category-list"><li><a href='/blog/categories/android'>android (1)</a></li><li><a href='/blog/categories/blog'>blog (1)</a></li><li><a href='/blog/categories/c-plus-plus'>c++ (18)</a></li><li><a href='/blog/categories/c-plus-plus-11'>c++11 (7)</a></li><li><a href='/blog/categories/c-plus-plus-14'>c++14 (1)</a></li><li><a href='/blog/categories/linux'>linux (2)</a></li><li><a href='/blog/categories/mongodb'>mongodb (1)</a></li><li><a href='/blog/categories/octopress'>octopress (2)</a></li><li><a href='/blog/categories/openshift'>openshift (1)</a></li><li><a href='/blog/categories/python'>python (1)</a></li><li><a href='/blog/categories/ruby'>ruby (1)</a></li><li><a href='/blog/categories/windbg'>windbg (1)</a></li><li><a href='/blog/categories/windows'>windows (7)</a></li><li><a href='/blog/categories/shu-xie'>书写 (1)</a></li><li><a href='/blog/categories/chan-pin'>产品 (1)</a></li><li><a href='/blog/categories/ren-sheng-gui-ji'>人生轨迹 (1)</a></li><li><a href='/blog/categories/hui-yi'>回忆 (5)</a></li><li><a href='/blog/categories/gong-zuo'>工作 (2)</a></li><li><a href='/blog/categories/gong-ju'>工具 (1)</a></li><li><a href='/blog/categories/bing-fa'>并发 (1)</a></li><li><a href='/blog/categories/zong-jie'>总结 (3)</a></li><li><a href='/blog/categories/cheng-xu-ren-sheng'>程序人生 (12)</a></li><li><a href='/blog/categories/xing-dong'>行动 (1)</a></li><li><a href='/blog/categories/ji-lu'>记录 (2)</a></li><li><a href='/blog/categories/du-shu'>读书 (1)</a></li><li><a href='/blog/categories/du-hou-gan'>读后感 (4)</a></li><li><a href='/blog/categories/yue-du'>阅读 (7)</a></li></ul>
</section>
<section>
  <h2>每日必读</h2>
   <ul>
    <li>
    <a href="http://news.ycombinator.com/">Hacker News</a>
    </li>
    <li>
    <a href="http://www.reddit.com/r/programming/">/r/programming</a>
    </li>
   </ul>
  <h2>关注博客</h2>
  <ul>
    <li>
      <a href="http://coolshell.cn/">酷壳</a>
    </li>
    <li>
      <a href="http://mindhacks.cn/">Mind Hacks</a>
    </li>
  </ul>
  <h2>友情链接</h2>
  <ul>
    <li>
      <a href="http://bestcbooks.com">计算机书籍控</a>
    </li>
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - ToWriting <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/whiterspace">whiterspace</a>.</span>
</p>

<p>
  <span class="credit">本站内容采用<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/">知识共享署名 3.0 中国大陆许可协议</a>进行许可</span>
</p></footer>
  











</body>
</html>
